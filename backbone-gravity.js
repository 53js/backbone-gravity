(function(){"use strict";var e=this,t=e.Backbone,i=e.Backbone.$,n=e._,o=e.BackboneGravity=e.BackboneGravity||{};o.Config=o.Config||{},o.Config.SCALE=30,o.Config.interval=1e3/60,o.Config.step=1/60,o.loop=function(){return function(t,i){(e.requestAnimationFrame||e.webkitRequestAnimationFrame||e.mozRequestAnimationFrame||e.oRequestAnimationFrame||e.msRequestAnimationFrame||function(t){e.setTimeout(t,o.Config.interval)})(t,i)}}(),o.Views=o.Views||{},o.Views.WorldView=t.View.extend({bodies:{},initialize:function(){this.world=new B2.b2World(new B2.b2Vec2(0,10),!0)},debug:function(){if(this.debugCanvas)return i(this.debugCanvas).fadeOut("fast"),this.debugCanvas=null,void 0;this.debugCanvas=document.getElementById("debug"),i(this.debugCanvas).fadeIn("fast"),this.debugCanvas.height=this.$el.height();var e=new B2.b2DebugDraw;e.SetSprite(this.debugCanvas.getContext("2d")),e.SetDrawScale(o.Config.SCALE),e.SetFillAlpha(.3),e.SetLineThickness(1),e.SetFlags(B2.b2DebugDraw.e_shapeBit|B2.b2DebugDraw.e_jointBit),this.world.SetDebugDraw(e),this.world.DrawDebugData()},createBody:function(e,i){e instanceof t.View||(i=n.extend({},e),e={});var o=n.extend({},s,e),a={};e instanceof t.View&&n.extend(a,{width:e.$el.outerWidth(),height:e.$el.outerHeight(),angle:1.5*Math.random()-1.5}),n.extend(a,i),o.create(this.world,a);var r=e.cid||i.cid;if(!r)throw"You must provide a view or an options.cid";this.bodies[r]=o},removeBody:function(e){this.bodies[e.cid]=null},resetBodies:function(){this.bodies=null},t:0,update:function(){this.stopped||(this.started=!0,this.world.Step(o.Config.step,10,10),n.each(this.bodies,n.bind(function(e){e.update()},this)),this.world.ClearForces(),this.debugCanvas&&this.world.DrawDebugData(),this.t++,o.loop(n.bind(this.update,this)))},stop:function(){this.started&&(this.stopped=!0,this.started=!1)}});var s=o.Body={settings:{dynamic:!0,density:1,friction:.5,restitution:.2,x:0,y:0,angle:0},create:function(e,t){var i=n.extend({},this.settings,t),s=new B2.b2FixtureDef;s.density=i.density,s.friction=i.friction,s.restitution=i.restitution,s.shape=new B2.b2PolygonShape,s.shape.SetAsBox(i.width/o.Config.SCALE/2,i.height/o.Config.SCALE/2);var a=new B2.b2BodyDef;a.type=i.dynamic?B2.b2Body.b2_dynamicBody:B2.b2Body.b2_staticBody,a.position.x=i.x/o.Config.SCALE,a.position.y=i.y/o.Config.SCALE,a.angle=i.angle;var r=this.body=e.CreateBody(a);return r.CreateFixture(s),r},getPosition:function(){var e=this.body.GetPosition();return{x:e.x*o.Config.SCALE,y:e.y*o.Config.SCALE}},setPosition:function(e){var t=this.body.GetPosition();return n.extend(t,{x:e.x?e.x/o.Config.SCALE:t.x,y:e.y?e.y/o.Config.SCALE:t.y}),this.body.SetPosition(new B2.b2Vec2(t.x,t.y)),t},getAngle:function(){return 180*this.body.GetAngle()/Math.PI},update:function(){}}}).call(this),function(){"use strict";window.B2={b2Vec2:Box2D.Common.Math.b2Vec2,b2AABB:Box2D.Collision.b2AABB,b2BodyDef:Box2D.Dynamics.b2BodyDef,b2Body:Box2D.Dynamics.b2Body,b2FixtureDef:Box2D.Dynamics.b2FixtureDef,b2Fixture:Box2D.Dynamics.b2Fixture,b2World:Box2D.Dynamics.b2World,b2MassData:Box2D.Collision.Shapes.b2MassData,b2PolygonShape:Box2D.Collision.Shapes.b2PolygonShape,b2CircleShape:Box2D.Collision.Shapes.b2CircleShape,b2DebugDraw:Box2D.Dynamics.b2DebugDraw,b2MouseJointDef:Box2D.Dynamics.Joints.b2MouseJointDef}}();